version: '3'
services:
  indexd:
    image: "quay.io/cdis/indexd"
    volumes:
      - ./apis_configs/indexd_settings.py:/var/www/indexd/local_settings.py
      - ./apis_configs/creds.json:/var/www/indexd/creds.json
      - ./apis_configs/config_helper.py:/var/www/indexd/config_helper.py
    ports:
      - "8080:80"
    depends_on:
      - postgres
  # fence:
  #   image: "quay.io/cdis/fence"
  #   volumes:
  #     - ./local_settings.py:/var/www/fence/local_settings.py
  #   ports:
  #     - "8081:80"
  #   depends_on:
  #     - postgres
  # peregrine:
  #   image: "quay.io/cdis/peregrine"
  #   # volumes:
  #   #   - ./peregrine_wsgi.py:/var/www/peregrine/wsgi.py
  #   ports:
  #     - "4000:80"
  #   depends_on:
  #     - postgres
  # sheepdog:
  #   image: "quay.io/cdis/sheepdog"
  #   # volumes:
  #   #   - ./gdcapi_wsgi.py:/var/www/gdcapi/wsgi.py
  #   ports:
  #     - "5000:80"
  #   depends_on:
  #     - postgres
  # dataportal:
  #   image: "quay.io/cdis/data-portal"
  #   ports:
  #     - "8083:80"
  #   depends_on:
  #     - postgres
  # nginx:
  #   image: "nginx"
  #   volumes:
  #     - ./nginx.conf:/etc/nginx/nginx.conf
  #   ports:
  #     - "80:80"
  #   # depends_on:
  #   #   - indexd
  #   #   - peregrine
  #   #   - sheepdogl
  #   #   - fence
  #   #   - dataportal
  postgres:
    image: postgres:9.5
    volumes:
      - "psqldata:/var/lib/postgresql/data"
      - "/home:/mnt/Users"
    ports:
      - 5432:5432
    restart: unless-stopped
    # environment:
    #   POSTGRES_USER: test
    #   POSTGRES_PASSWORD: test
    
volumes:
  psqldata: